<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
<!--  <link rel="stylesheet" type="text/css" href="/css/main/store.css">-->
  <link rel="stylesheet" type="text/css" href="/css/question/question_list.css">
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
</head>
<body>

<!-- 페이지 상단 -->
<th:block th:include="/seller/seller_top.html"></th:block>


<div id="questions-index-page">
  <section id="questions-header">
    <div class="container">
      <div class="questions-header__title">
        <h1 class="text-heading-1 text-black bold">내 주문 관리</h1>
      </div>
      <form id="questions-header__form" class="sticky-top"
            th:action="@{/sellerOrder/{memberId}(memberId=${session.loginMember.memberId},currentPageNo=${criteria.currentPageNo})}" accept-charset="UTF-8" method="get">
        <input name="utf8" type="hidden" value="✓">
        <div class="sticky-content">
          <div class="questions-header__form__wrap row">
            <div class="questions-header__form__search col">
              <div class="questions-header__form__search__input">
                <select id="questionCategory_filters"  name="searchType"  onchange="" >
                  <option class="filter-select__list__entry"   value="" th:selected="${criteria.searchType == null}">선택하세요</option>
                  <option class="filter-select__list__entry" value="search_productTitle" th:text="상품명" th:selected="${criteria.searchType == 'search_productTitle'}"/>
                  <option class="filter-select__list__entry" value="search_userAccountId" th:text="구매자아이디" th:selected="${criteria.searchType == 'search_userAccountId'}"/>
                </select>
                <img src="/img/redhome_search.PNG"
                     style="position: absolute; padding-top: 21px; padding-left: 21px;" class="searchBtn" onclick="search()">
                <input type="text" name="searchKeyword"
                       id="questions-header__form__search" th:attr="value=${criteria.searchKeyword}"
                       class="form-control" placeholder="주문 검색."
                       autocomplete="off"/>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </section>
</div>



<section id="questions-filter" class="sticky-top" >
  <div class="questions-filter__content container">

    <div class="questions-filter__filters">
      <div class="filter-select" id="questions-filter-sort" data-modal-id="questions-filter-sort-modal">
        <dl class="filter-select__header" role="button" onclick="showSort()" ondblclick="hideSort()">
          <dt class="filter-select__header__name">
            정렬<span class="icon icon-pointer-angle-down-dark-sm"></span>
          </dt>
          <th:block th:if="${orderType != 'latest' && orderType !='old'}">
            <dd class="filter-select__header__value" th:text="최신순"></dd>
          </th:block>
          <th:block th:if="${orderType == 'latest'}">
            <dd class="filter-select__header__value" th:text="최신순"></dd>
          </th:block>
          <th:block th:if="${orderType == 'old'}">
            <dd class="filter-select__header__value" th:text="오래된순"></dd>
          </th:block>

        </dl>
        <ul class="filter-select__list" id="filter-select__list" >
          <li class="filter-select__list__entry" th:classappend="${orderType == 'latest' and orderType != 'mostPopular'} ?'active':''" >
            <a class="filter-select__list_newCommunity sort"  th:href="@{/sellerOrder/{memberId}(memberId=${session.loginMember.memberId}, currentPageNo=1, reply=${reply}, orderType='latest', searchType=${criteria.searchType}, searchKeyword=${criteria.searchKeyword})}"  th:id="${orderType == 'latest'} ?'activeList':'notactiveList1'" onmouseover="newCommunityFocus()" >최신순</a>
          </li>
          <li class="filter-select__list__entry" th:classappend="${orderType == 'old'} ?'active':''"  >
            <a class="filter-select__list_newComment sort" th:href="@{/sellerOrder/{memberId}(memberId=${session.loginMember.memberId}, currentPageNo=1, reply=${reply}, orderType='old', searchType=${criteria.searchType}, searchKeyword=${criteria.searchKeyword})}" th:id="${orderType == 'old'} ?'activeList':'notactiveList2'" onmouseover="newCommentFocus()">오래된순</a>
          </li>
        </ul>
      </div>
    </div>







  </div>
  </div>
</section>

<section>
  <div class="order-list container">
    <div class="order-list__content">
      <div class="review-my-home__search">
        <div class="review-my-home__search__title">주문내역</div>
      </div>

      <!--구매내역 반복-->
      <section class="css-12lzt4u-List e1yy3fi630" th:each="order:${orderList}">
        <div class="css-1l0e9nh-Header e1yy3fi629">
          <div class="css-1q29q5y-HeaderTitle e1yy3fi628" th:text="${order.orderNumber}+' | '+${order.orderDate}+' | '+${order.accountId}">57244440 | 2021.05.14 | id</div>
        <div>
          <div>
            <div class="css-92bd9c-Item e1yy3fi626">
              <div class="css-1ih37x6-Content e1yy3fi625">
                <picture>
                  <img class="css-1gfeya1-ProductImage e1yy3fi624"
                       th:src="@{${'/display?fileName='+order.productMainImage}}">
                  <!--srcset="https://image.ohou.se/i/bucketplace-v2-development/uploads/
                  productions/15650448025678_7pGSb.jpg?w=180&amp;h=180&amp;c=c
                   1.5x,https://image.ohou.se/i/bucketplace-v2-development/uploads/
                   productions/15650448025678_7pGSb.jpg?w=256&amp;h=256&amp;c=c 2x,
                   https://image.ohou.se/i/bucketplace-v2-development/uploads/productions/
                   15650448025678_7pGSb.jpg?w=360&amp;h=360&amp;c=c 3x">-->
                </picture>
                <div class="css-1typuwb-Explain e1yy3fi623">
                  <div class="css-lx7s3c-ExplainWrap e1yy3fi622">
                    <a  class="css-1nto2s9-ProductNameLink e1yy3fi620"
                        href="/productions/324144/selling" th:text="${order.productTitle}">[기간한정]
                      글린 LED 3단 서랍침대 매트포함 (SS/Q) 4colors</a>
                    <div class="css-1c7n34t-ProductDelivery e1yy3fi617" th:text="${order.orderState}" style="padding-top:10px" >구매확정 </div>
                  </div>
                  <div class="css-lx7s3c-ExplainWrap e1yy3fi622">
                    <!--<div class="css-1u68l27-ProductOption e1yy3fi619">선택: 슈퍼싱글(SS)+필로우탑60T / 색상: 오크
                    </div>-->
                    <div class="css-1fnh3w3-ProductPriceAndCount e1yy3fi618" th:text="'가격 : '+${order.orderUnitPrice}+'원'">349,000원 | 1개</div>
                    <div class="css-1fnh3w3-ProductPriceAndCount e1yy3fi618" th:text="'수량 : '+${order.orderProductQuantity}+'개'">349,000원 | 1개</div>

                  </div>
                </div>
              </div>
              <div class="css-d2162a-ProductActions e1yy3fi615">

              </div>
            </div>
          </div>
        </div>
      </section>




    </div>

  </div>
</section>




<section id="questions-list" class="container">
  <th:block th:each= "order : ${orderList}" >
<!--    <a class="questions-item__link" th:href="@{/product/detail(productId=${question.productId}, currentPageNo=${criteria.currentPageNo}, reply=${reply},orderType=${orderType} , searchType=${criteria.searchType}, searchKeyword=${criteria.searchKeyword}, commentCurrentPage =1)}"  >-->
      <article class="questions-item">
        <a class="questions-item__link" th:href="@{/product/detail(productId=${order.productId}, currentPageNo=${criteria.currentPageNo}, reply=${reply},orderType=${orderType} , searchType=${criteria.searchType}, searchKeyword=${criteria.searchKeyword}, commentCurrentPage =1)}"  >
        <th:block th:if="${order.productMainImage ne null }">
          <div class="questions-item__image">
            <div class="image-wrap square">
              <img th:src="@{${'/display?fileName='+order.productMainImage}}">
            </div>
          </div>
        </th:block>


        <h1 class="questions-item__title text-heading-5 bold text-black"th:text="'<'+ ${order.productId} + '> '+ ${order.productTitle}"></h1>
        <p class="questions-item__content text-caption-1" th:text="${question.questionContents}"></p>
        </a>
        <footer class="questions-item__footer">
            <span class="questions-item__footer__author">
                <span class="questions-item__footer__author__content text-caption-1" th:text="${question.userAccountId}"></span>
            </span>
          <span class="questions-item__footer__meta text-caption-1">
              <time datetime="2021-05-04T13:16:13+09:00" class="questions-item__footer__date text-gray" th:text="${#temporals.format(question.questionDate,'yyyy-MM-dd HH:mm:ss') }"></time>
              <span class="questions-item__footer__comments text-gray">
                답변상태
              </span>
              <a class="questions-item__footer__comments__content" th:if="${question.questionState == '답변대기'}" th:text="답변하기" style="cursor: pointer; color: #f76565" th:href="@{/answer/add(productId=${question.productId}, questionId=${question.questionId})}"></a>
              <span class="questions-item__footer__comments__content" th:if="${question.questionState == '답변완료'}" th:text="답변완료" style="color: #9a112c"></span>

              </span>

        </footer>
      </article>
<!--    </a>-->
  </th:block>
</section>

<!--로그인 체크 필요 없게되면 추후 삭제 예정-->
<input type="hidden"  id="memberId" th:value="${session.loginMember == null? null: session.loginMember.memberId} "/>



<div class="paging">
  <ul class="pagination">
    <!--이전  버튼-->
    <th:block th:if="${pageMaker.hasPreviousPage}">
      <li class="page-item">
        <a class ="page-link" id="Previous"  th:href="@{/sellerQuestion/{memberId}(memberId=${session.loginMember.memberId}, currentPageNo=${pageMaker.firstPage} - 1, reply=${reply},orderType=${orderType} , searchType=${criteria.searchType}, searchKeyword=${criteria.searchKeyword})}" tabindex="-1">Prev</a>
      </li>
    </th:block>



    <!--페이지 번호-->
    <th:block th:each="page: ${#numbers.sequence(pageMaker.firstPage,pageMaker.lastPage)}">
      <li class="page-item" th:classappend="${criteria.currentPageNo == page} ?'active':''"
          th:attr="id=${criteria.currentPageNo == page} ? 'pageActive' : 'pageNoActive'" >
        <a class ="page-link" id="pageNum"  th:href="@{/sellerQuestion/{memberId}(memberId=${session.loginMember.memberId}, currentPageNo=${page}, reply=${reply},orderType=${orderType} , searchType=${criteria.searchType}, searchKeyword=${criteria.searchKeyword})}" th:text="${page == 0 ? '': page}" ></a>
      </li>
    </th:block>


    <!--다음 버튼-->
    <th:block th:if="${pageMaker.hasNextPage}">
      <li class="page-item" >
        <a class ="page-link" id="Next" th:href="@{/sellerQuestion/{memberId}(memberId=${session.loginMember.memberId}, currentPageNo=${pageMaker.lastPage} + 1, reply=${reply},orderType=${orderType} , searchType=${criteria.searchType}, searchKeyword=${criteria.searchKeyword} )}"  tabindex="-1">Next</a>
      </li>
    </th:block>

  </ul>
</div>

<!-- 페이지 하단 -->
<th:block th:include="/fragments/bottom.html"></th:block>







<br>





<!-- 페이지 하단 -->
<th:block th:include="/fragments/bottom.html"></th:block>

<script>

  /*로그인 체크 필요 없게되면 추후 삭제 예정*/
  function loginCheck(){

    let memberId = document.getElementById("memberId").value;
    if(memberId == null || memberId == ''){
      alert('로그인 후 커뮤니티 글 작성이 가능합니다.');
      location.href ='/login';
    }else{
      location.href='/community/add';
    }


  }





  function reply(){

    let reply = document.getElementsByClassName("set-reply")[0].id;
    let href = document.getElementById(reply).getAttribute('href');
    location.href=href;

  }


  function showSort(){

  let sort =  document.getElementById("filter-select__list");

    sort.style.visibility='visible';
    sort.style.opacity='1';
    sort.style.transform='none';
    sort.style.top='470px';
    sort.style.left='290px';

  }

  function hideSort(){
    let sort =  document.getElementById("filter-select__list");
    sort.style.visibility='hidden';
    sort.style.opacity='0';

  }


  function newCommunityFocus(){
    let sort = document.getElementsByClassName("sort")[0].id;
    document.getElementById(sort).style.backgroundColor='#f76565';
    document.getElementById(sort).style.color='white';


    document.getElementById(sort).addEventListener('mouseout', function (){

    if(sort == 'activeList'){
    document.getElementById(sort).style.backgroundColor='white';
    document.getElementById(sort).style.color='#f76565';


  }else{
    document.getElementById(sort).style.backgroundColor='white';
    document.getElementById(sort).style.color='#424242';
  }

  });

  }

  function newCommentFocus(){
  let sort = document.getElementsByClassName("sort")[1].id;
  document.getElementById(sort).style.backgroundColor='#f76565';
  document.getElementById(sort).style.color='white';


  document.getElementById(sort).addEventListener('mouseout', function (){

  if(sort == 'activeList'){
  document.getElementById(sort).style.backgroundColor='white';
  document.getElementById(sort).style.color='#f76565';


  }else{
    document.getElementById(sort).style.backgroundColor='white';
    document.getElementById(sort).style.color='#424242';
  }

});

}



  function mostPopularFocus(){
    let sort = document.getElementsByClassName("sort")[2].id;
    document.getElementById(sort).style.backgroundColor='#f76565';
    document.getElementById(sort).style.color='white';


    document.getElementById(sort).addEventListener('mouseout', function (){

    if(sort == 'activeList'){
    document.getElementById(sort).style.backgroundColor='white';
    document.getElementById(sort).style.color='#f76565';


  }else{
    document.getElementById(sort).style.backgroundColor='white';
    document.getElementById(sort).style.color='#424242';
  }

  });

  }


  function search(){

    let type = document.getElementById('questionCategory_filters').value;
    let keyword = document.getElementById('questions-header__form__search').value;

    if((type == null || type =='')&&(keyword == null || keyword == '')) {
    alert('검색 종류와 검색 키워드를 입력해 주세요.');
    return false;
  }else if(type == null || type ==''){
    alert('검색 종류를 선택해 주세요.');
    return false;
  }else if(keyword == null || keyword == ''){
    alert('검색 키워드를 입력해 주세요.');
    return false;
  }

    document.getElementById('questions-header__form').submit();
  }

</script>

</body>


</html>